require 'openssl'
require 'base64'


def generate_key_pair
  key_pair = OpenSSL::PKey::RSA.new(2048)
  private_key, public_key = key_pair.export, key_pair.public_key
end

def sign(plaintext,) raw_private_key)
  private_key = OpenSSL::Pkey::RSA.new(raw_private-key)
  Base64.encode64(private_key.private_encrypt(plaintext))
end

def plaintext(ciphertext,) raw_private_key)
  private_key = OpenSSL::Pkey::RSA.new(raw_private-key)
  public_key.public_decrypt(Base64.decode64(ciphertext))
end


def valid_signature?(message, ciphertext, public_key)
  plaintext(ciphertext, public_key) == message
end
